
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Formulaire Veille IA ‚Äì Janvier & Picto</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 p-4 font-sans">
  <div class="max-w-6xl mx-auto bg-white shadow rounded-xl p-6">
    <h1 class="text-3xl font-bold text-center text-blue-700 mb-6">Formulaire de Veille IA ‚Äì Janvier & Picto</h1>

    <!-- Infos g√©n√©rales -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
      <div>
        <label for="periode" class="block font-semibold">P√©riode :</label>
        <input id="periode" class="w-full border p-2 rounded" type="text" required />
      </div>
      <div>
        <label for="referents" class="block font-semibold">R√©f√©rents :</label>
        <input id="referents" class="w-full border p-2 rounded" type="text" required />
      </div>
      <div>
        <label for="service" class="block font-semibold">Service :</label>
        <input id="service" class="w-full border p-2 rounded" type="text" required />
      </div>
    </div>

    <!-- Section Veille -->
    <h2 class="text-xl font-bold mt-6 mb-2">Veille</h2>
    <table id="veilleTable" class="w-full table-auto border mb-4">
      <thead>
        <tr class="bg-gray-200">
          <th class="border p-2">Type</th>
          <th class="border p-2">Source</th>
          <th class="border p-2">Cat√©gorie</th>
          <th class="border p-2">Canal</th>
          <th class="border p-2">Commentaire</th>
          <th class="border p-2">Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <button onclick="ajouterVeille()" class="bg-blue-600 text-white px-4 py-2 rounded">Ajouter une veille</button>

    <!-- Bouton ENVOYER -->
    <div class="mt-10 text-center">
      <button onclick="envoyerDonnees()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-bold text-lg">Envoyer</button>
    </div>
  </div>

  <script>
    const url = "https://script.google.com/macros/s/AKfycbx1hrFXyFsC9-H9KiJOfIm-jPn-Er5RkzUcfAANJj7_X7u3g1CuFmaT0BT6YU316GQq/exec";

    function getBaseInfos() {
      return {
        periode: document.getElementById("periode").value,
        referents: document.getElementById("referents").value,
        service: document.getElementById("service").value
      };
    }

    function ajouterVeille() {
      const table = document.getElementById("veilleTable").getElementsByTagName("tbody")[0];
      const row = table.insertRow();
      row.innerHTML = `
        <td class="border p-2"><input class="w-full" placeholder="Type" /></td>
        <td class="border p-2"><input class="w-full" placeholder="Source" /></td>
        <td class="border p-2"><input class="w-full" placeholder="Cat√©gorie" /></td>
        <td class="border p-2"><input class="w-full" placeholder="Canal" /></td>
        <td class="border p-2"><input class="w-full" placeholder="Commentaire" /></td>
        <td class="border p-2 text-center"><button onclick="this.parentElement.parentElement.remove()">üóëÔ∏è</button></td>`;
    }

    function envoyerDonnees() {
      const infos = getBaseInfos();
      document.querySelectorAll("#veilleTable tbody tr").forEach(row => {
        const cells = row.querySelectorAll("input");
        const data = {
          type: "veille",
          ...infos,
          veille_type: cells[0].value,
          source: cells[1].value,
          categorie: cells[2].value,
          canal: cells[3].value,
          commentaire: cells[4].value
        };
        fetch(url, {
          method: "POST",
          mode: "no-cors",
          body: JSON.stringify(data)
        });
      });

      alert("‚úÖ Donn√©es envoy√©es !");
    }
  </script>
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzWVLm8l0paMK540HEv1yACE0CqinTH44yfMhrm9BuTaudnE40UtRITEXyHtWV4TMpN/exec";

  function gatherAllData() {
    return {
      periode: document.getElementById('periode').value,
      referents: document.getElementById('referents').value,
      service: document.getElementById('service').value,
      // ici : collecte de toutes les tables/rubriques (veille, tests, feedback...).
      // tu peux cr√©er un tableau pour chaque type, ex. :
      veille: Array.from(document.querySelectorAll('#solutions-table .solution-row')).map(r => ({
        solution: r.querySelector('input').value,
        type: r.querySelector('select').value,
        // etc.
      })),
      // idem : evolutions, tests, formations...
    };
  }

  function envoyerDonnees() {
    const data = gatherAllData();
    fetch(SCRIPT_URL, {
      method: 'POST',
      body: JSON.stringify(data)
    })
    .then(r => alert('‚úÖ Donn√©es envoy√©es !'))
    .catch(e => alert('‚ùå Erreur : ' + e.message));
  }
</script>

</body>
</html>
